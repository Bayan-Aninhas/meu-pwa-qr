<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QR Equip - Home</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#FFFFFF">

<script>
  const token = localStorage.getItem('token');
  const isOnline = navigator.onLine;

  // Nunca logado
  if (!token) {
    window.location.replace('/');
  }

  // Offline + sem token
  if (!isOnline && !token) {
    window.location.replace('/offline');
  }
</script>

</head>
<body>

<header>
    <div class="user-icon">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="8" r="4" stroke="white" stroke-width="2"/>
            <path d="M6 21v-2a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v2" stroke="white" stroke-width="2"/>
        </svg>
    </div>
    <div>
        <h1>QR Equip</h1>
        <p>Manage Equipment with QR Codes</p>
    </div>
</header>

<main>
    <section class="hero">
        <h2>Bem-vindo ao QR Equip</h2>
        <p>Regista e pesquisa equipamentos de forma eficiente usando QR Codes.</p>
    </section>

    <section class="features">
        <article class="feature">
            <div class="qr-icon">
                 <img src="{{ url_for('static', filename='images/qr-create.png') }}" alt="QR Create Icon">
            </div>
            <h3>Registo Equipamento</h3>
            <p>Crie códigos QR para os equipamentos </p>
            <button class="btn" id="registo-btn">Registar</button>
        </article>
        <article class="feature">
            <div class="qr-icon">
                 <img src="{{ url_for('static', filename='images/qr-search.png') }}" alt="QR Search Icon">
            </div>
            <h3>Procurar Equipamento</h3>
            <p>Use a câmara para ler códigos QR</p>
            <button class="btn" id="procurar-btn">Procurar</button>
        </article>
    </section>
</main>

<!-- MODAIS -->
<div class="modal" id="registo-modal">
    <div class="modal-content">
        <span class="close" id="close-registo">&times;</span>
        <h2>Registo Equipamento</h2>
        <input type="text" placeholder="Nome" id="nome-registo">
        <input type="text" placeholder="Localização" id="localizacao">
        <input type="text" placeholder="Estado" id="estado">
        <button id="confirmar-registo">Confirmar Registo</button>
    </div>
</div>

<div class="modal" id="codigo-modal">
    <div class="modal-content">
        <span class="close" id="close-codigo">&times;</span>
        <h2>CODIGO :</h2>
        <p id="codigo-display"></p>
        <button id="imprimir-qr">Imprimir QR</button>
        <button id="fechar-codigo">Fechar</button>
    </div>
</div>

<div class="modal" id="procurar-modal">
    <div class="modal-content">
        <span class="close" id="close-procurar">&times;</span>
        <h2>Procurar Equipamento</h2>
        <div id="qr-reader" style="width: 100%; max-width: 300px; margin: 0 auto;"></div>
        <input type="text" placeholder="Código do Equipamento" id="codigo" readonly>
        <button id="confirmar-procurar">Procurar</button>
        <div id="resultado-equipamento" style="margin-top: 15px; display: none;">
            <h3>Resultado:</h3>
            <p><strong>Nome:</strong> <span id="res-nome"></span></p>
            <p><strong>Localização:</strong> <span id="res-localizacao"></span></p>
            <p><strong>Estado:</strong> <span id="res-estado"></span></p>
        </div>
    </div>
</div>

<footer>
    <p>&copy; 2025 QR Equip. Todos os direitos reservados.</p>
</footer>

<!-- Scripts -->
<script src="{{ url_for('static', filename='libs/html5-qrcode.min.js') }}"></script>
<script src="app.js"></script>
<script src="{{ url_for('static', filename='js/home.js') }}"></script>

</body>
</html>
